<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Installation - The EGI v2 guide</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The EGI v2 guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<h2 id="installing-rust"><a class="header" href="#installing-rust">Installing Rust</a></h2>
<p>EGI v2 is written in <a href="https://www.rust-lang.org/">Rust</a>, so you will need a Rust toolchain installed to compile it.
To check if you do, run the command <code>cargo --help</code> in a terminal.
(<code>cargo</code> is Rust's build tool and package manager.)
You should see output like this:</p>
<pre><code class="language-bash">$ cargo --help
Rust's package manager

Usage: cargo [+toolchain] [OPTIONS] [COMMAND]
       cargo [+toolchain] [OPTIONS] -Zscript &lt;MANIFEST_RS&gt; [ARGS]...
</code></pre>
<p>If so, you can skip the rest of this section.
If not, installing Rust is simple and does not require administrative privileges.
If you are working on a high performance cluster, double check that Rust/cargo aren't already available by loading a module.</p>
<p>To install Rust, use the <code>rustup</code> manager by following the instructions <a href="https://www.rust-lang.org/tools/install">on the rust-lang website</a>.</p>
<h2 id="installing-ggg"><a class="header" href="#installing-ggg">Installing GGG</a></h2>
<p>EGI is a wrapper around the GGG retrieval software, developed at JPL.
You will need GGG installed for EGI to work.
Full instructions to install are given <a href="https://tccon-wiki.caltech.edu/Main/GGG2020ReleaseNotes">on the TCCON wiki</a>.
The very brief version is:</p>
<ol>
<li>Ensure you have a Fortran compiler and the <a href="https://www.anaconda.com/download/"><code>conda</code> package manager</a> installed and available on your system.
The <code>miniconda</code> Python installation provides a minimal Python install and <code>conda</code> manager, and is ideal for this purpose.
<code>gfortran</code> is the default Fortran compiler for GGG; to use another compiler will require you to link the proper compiler script in GGG's <code>install</code> subdirectory.</li>
<li>Download the latest release from https://github.com/TCCON/GGG and untar it.</li>
<li>Set the <code>GGGPATH</code> and <code>gggpath</code> environmental variables for your shell to point to the GGG directory.
These should go in your <code>~/.bashrc</code> or equivalent file.
For example, if <code>/home/user/ggg</code> is the directory that you expanded from the release tarball (it should contain subdirectories such as <code>isotopologs</code> and <code>linelist</code>),
and you use Bash, then add the following to <code>~/.bashrc</code>:</li>
</ol>
<pre><code class="language-bash">export GGGPATH=/home/user/ggg
export gggpath=/home/user/ggg
</code></pre>
<p>If your shell is ZSH, then the syntax is the same, but you would modify <code>~/.zshrc</code> instead.
You can check which shell you have by running the command <code>echo $SHELL</code> in a terminal.</p>
<h2 id="installing-ggg-rs"><a class="header" href="#installing-ggg-rs">Installing GGG-RS</a></h2>
<p>EGI-RS uses some developmental replacements for the GGG post processing programs that have more flexibility to handle
EM27/SUN-specific settings.
Because this is part of a repo still under development, installation is a bit annoying at present.
We will do our best to simplify this in the future.</p>
<p>For now, the following steps will install these programs:</p>
<ol>
<li>Set the environmental variable <code>GGGRS_NCDIR</code> to point to the environment created as part of installing GGG.
Depending on your GGG installation process, this might be at <code>$GGGPATH/install/.condaenv</code> or a named environment
managed by conda. If you do not have a <code>$GGGPATH/install/.condaenv</code>, run <code>conda env list</code> and find the path for
an environment named "ggg-tccon-default".
See the <a href="#installing-ggg">Installing GGG</a> section above for how to set environmental variables.
After modifying your <code>~/.bashrc</code> or <code>~/.zshrc</code> file, run <code>source ~/.bashrc</code> or <code>source ~/.zshrc</code> to include the
new environmental variable in your shell.</li>
<li>Change directory into your <code>$GGGPATH</code>, directory (<code>cd $GGGPATH</code>)</li>
<li>Clone the GGG-RS repo as <code>src-rs</code> (<code>git clone https://github.com/TCCON/ggg-rs.git src-rs</code>)</li>
<li>Change into the <code>src-rs</code> directory and run the <code>make</code> command.</li>
</ol>
<p>Compilation may take a few minutes.
If all goes well, you should see a message similar to the following:</p>
<pre><code>   Installed package `ggg-rs v0.1.0 (/home/you/ggg/src-rs)` (executables `add_nc_flags`, `apply_tccon_airmass_correction`, `bin2nc`, `change_ggg_files`, `collate_tccon_results`, `i2s_setup`, `list_spectra`, `plot_opus_spectra`, `query_output`, `strip_header`)
warning: be sure to add `/home/you/ggg/bin` to your PATH to be able to run the installed binaries
</code></pre>
<p>You can ignore the warning about adding a directory to your PATH; we will always be calling these programs with their full path, so adding the directory to your PATH (which it so you only need to type the program name to run it).
If you encounter trouble, see the <a href="https://github.com/TCCON/ggg-rs">GGG-RS README</a> for suggestions.
To free up space, you can run the <code>cargo clean</code> command in <code>$GGGPATH/src-rs</code> to delete intermediate compilation files not needed any more.</p>
<h2 id="installing-egi-rs"><a class="header" href="#installing-egi-rs">Installing EGI-RS</a></h2>
<p>Once you have GGG-RS installed, installing EGI-RS is easy.
Simply run the following command from anywhere:</p>
<pre><code class="language-bash">cargo install --git https://github.com/TCCON/egi-rs --root "$GGGPATH"
</code></pre>
<p>Similarly to installing GGG-RS, you should see a message similar to:</p>
<pre><code>   Installed package `egi-rs v0.1.0 (https://github.com/TCCON/egi-rs#2d7a442c)` (executables `em27-catalogue`, `em27-gfit-prep`, `em27-i2s-prep`, `em27-init`)
warning: be sure to add `/home/you/ggg/bin` to your PATH to be able to run the installed binaries
</code></pre>
<p>Again, we can ignore that warning.
The final step is to run the <code>em27-init</code> program we just installed.
This will add some extra EM27/SUN-specific files to your <code>$GGGPATH</code>.
It will print out a summary; all steps should read "OK".
If not, or if you got a fatal error earlier in the run, correct the issue and try again.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->

                            <a rel="next prefetch" href="igm-coords.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

                    <a rel="next prefetch" href="igm-coords.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
